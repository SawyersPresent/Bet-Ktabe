

Sh - Proxylogon CVE-2021-26855 ✔️  

```
shodan init kNWoMbgDfszHJqH95uAe0lelO4AsQIim
shodan init QPWbPNV5UODo5TMNvUdFpXEiSG8DbnWm
shodan init IYbvYxdkAlQCMNqaOirU7JYU9hsQVHlm
```


#### Way One

```
shodan download exchange.json.gz vuln:cve-2021-26855

shodan parse exchange.json.gz --fields=ip_str,port > proxylogon_all_443.txt

awk '{count[$2]++} END {for (port in count) print count[port], "occurrences - Port", port}' proxylogon_all_443.txt | sort -rn

grep -E '\s443$' proxylogon_all_443.txt | awk '{print $1}' > proxylogon_vuln443.txt

nuclei -l proxylogon_vuln443.txt -t ~/nuclei-templates -id CVE-2021-26855 -o proxylogon_eu.txt
```

---
#### Way Two

```
shodan download --limit 5000000 outlook_mail_servers_eu.json.gz "X-AspNet-Version" http.title:"Outlook" country:"AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI" vuln:cve-2021-26855

shodan parse outlook_mail_servers_eu.json.gz --fields=ip_str,port > outlook_mail_eu.txt

awk '{count[$2]++} END {for (port in count) print count[port], "occurrences - Port", port}' outlook_mail_eu.txt | sort -rn

grep -E '\s443$' outlook_mail_eu.txt | awk '{print $1}' > outlook_mail_ip_eu.txt

nuclei -l outlook_mail_ip_eu.txt -t ~/nuclei-templates -id CVE-2021-26855 -o proxylogon_eu.txt
```

---
#### Way Three

```
Filter on Country

shodan download --limit 5000000 outlook_mail_servers_nl.json.gz "X-AspNet-Version" http.title:"Outlook" country:"NL" vuln:cve-2021-26855

shodan parse outlook_mail_servers_nl.json.gz --fields=ip_str,port > outlook_mail_servers_nl.txt

grep -E '\s443$' outlook_mail_servers_nl.txt | awk '{print $1}' > outlook_mail_servers_ip_nl.txt

nuclei -l outlook_mail_servers_ip_nl.txt -t ~/nuclei-templates -id CVE-2021-26855 -o proxylogon_nl.txt
```