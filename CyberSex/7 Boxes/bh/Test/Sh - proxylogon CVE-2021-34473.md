

Scan for [Proxyshell](https://www.mandiant.com/resources/blog/pst-want-shell-proxyshell-exploiting-microsoft-exchange-servers):

- `sudo [masscan](https://github.com/robertdavidgraham/masscan) -Pn -sS -iL [ranges.txt](https://github.com/herrbischoff/country-ip-blocks) --rate 50000 -p443 --open-only --excludefile [block.txt](https://gist.github.com/ozuma/fb21ab0f7143579b1f2794f4af746fb2) | grep -Eo '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' > results.txt`

- `sed -i 's/$/:443/' results.txt`

- `[nuclei](https://github.com/projectdiscovery/nuclei) -l results.txt -t [nuclei-templates/http/cves/2021/CVE-2021-34473.yaml](https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2021/CVE-2021-34473.yaml) -o vulns.txt`




#### Way One

```
shodan download exchange.json.gz vuln:cve-2021-26855

shodan parse exchange.json.gz --fields=ip_str,port > proxylogon_all_443.txt

awk '{count[$2]++} END {for (port in count) print count[port], "occurrences - Port", port}' proxylogon_all_443.txt | sort -rn

grep -E '\s443$' proxylogon_all_443.txt | awk '{print $1}' > proxylogon_vuln443.txt

nuclei -l proxylogon_vuln443.txt -t ~/nuclei-templates -id CVE-2021-34473 -o proxylogon_eu.txt
```

